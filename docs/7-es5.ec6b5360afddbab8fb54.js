function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,n){if(t){if("string"==typeof t)return _arrayLikeToArray(t,n);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,n):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,n){(null==n||n>t.length)&&(n=t.length);for(var o=0,i=new Array(n);o<n;o++)i[o]=t[o];return i}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var o=0;o<n.length;o++){var i=n[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,n,o){return n&&_defineProperties(t.prototype,n),o&&_defineProperties(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{OVhx:function(t,n,o){"use strict";o.r(n),o.d(n,"CombatModule",(function(){return N}));var i,e=o("ofXK"),p=(o("2Vo4"),o("lJxs")),c=o("QuZ5"),h=o("fXoL"),r=o("QPBi"),s=o("4Y61"),a=o("DcRq"),x=o("cOoP"),g=o("sYnD"),d=o("IzEk"),l=o("SxV6"),b=o("IM8C"),u=o("kt0X"),_=o("tyNb"),f=o("uIK9"),w=o("Pgg3"),C=o("l5mm"),P=o("PqYM"),O=o("h4i/"),k=o("ozXD"),M=o("7cwC"),y=((i=function(){function t(n,o){_classCallCheck(this,t),this.store=n,this._notifier=o,this.fightIntervals=new Set}return _createClass(t,[{key:"initialize",value:function(t){this.hero=t,this.isFigthing||(this.isFigthing=!0,this.resetFighter(),this.initHero(),this.startFight())}},{key:"resetFighter",value:function(){var t;this.fighter.hp=this.fighter.maxHp,null===(t=this.fighter.debuffs)||void 0===t||t.forEach((function(t){clearTimeout(t.timeOut),clearInterval(t.interval)})),this.fighter.debuffs=[]}},{key:"initHero",value:function(){var t,n=_toConsumableArray(this.hero.equippedSpell).map((function(t){return Object.assign(Object.assign({},t),{isInCooldown:!1})}));this.store.dispatch(new g.p(Object.assign(Object.assign({},this.hero),{hp:this.hero.maxHp,equippedSpell:n,potion:Object.assign(Object.assign({},null===(t=this.hero)||void 0===t?void 0:t.potion),{isInCooldown:!1})})))}},{key:"heroAttack",value:function(){var t=this,n=Object(w.d)(this.hero,"weapon");return Object(C.a)("null"!==n.id?Object(w.j)("swiftness",this.hero,n.speed):Object(w.j)("swiftness",this.hero,1e3)).subscribe((function(){var n=1,o=Object(w.e)(t.hero),i="You hit for ".concat(o);Object(w.l)(t.hero)&&(n=2,i="You critical hit for : ".concat(2*o)),t.fighter.hp=Math.floor(t.fighter.hp-o*n),t._notifier.notify(i,"","text",0,2e3),t.store.dispatch(new g.p(Object(w.m)(t.hero,o*n,t._notifier))),t.fighter.hp<=0&&(t.victory(),t.death())}))}},{key:"fighterAttack",value:function(){var t=this;return Object(C.a)(this.fighter.attackSpeed).subscribe((function(){t.store.dispatch(new g.p(Object.assign(Object.assign({},t.hero),{hp:t.hero.hp-t.fighter.attack}))),t.hero.hp<=0&&t.death()}))}},{key:"launchSpell",value:function(t){var n=this;t.equippedSpell.forEach((function(t){return n.activateSpell(t)}))}},{key:"startFight",value:function(){this.fightIntervals.add(this.heroAttack()),this.fightIntervals.add(this.fighterAttack()),this.launchSpell(this.hero)}},{key:"stop",value:function(){this.fightIntervals.forEach((function(t){t.unsubscribe()})),this.fightIntervals.clear(),this.isFigthing=!1}},{key:"death",value:function(){this.stop(),this.initialize(this.hero)}},{key:"activateSpell",value:function(t){var n=this;Object(f.b)(t,this.fighter,this.hero,Object(w.l)(this.hero),this._notifier,this.store),this.store.dispatch(new g.d(Object.assign(Object.assign({},t),{isInCooldown:!0}))),this.fightIntervals.add(Object(P.a)(Object(w.j)("swiftness",this.hero,1e3*t.cooldown)).subscribe((function(){n.store.dispatch(new g.d(Object.assign(Object.assign({},t),{isInCooldown:!1}))),setTimeout((function(){return n.activateSpell(t)}),10)}))),this.fighter.hp<=0&&(this.victory(),this.death())}},{key:"usePotion",value:function(t){var n=this;Object(k.b)(t,this.hero,this.store,this._notifier),this.store.dispatch(new g.c(Object.assign(Object.assign({},t),{isInCooldown:!0}))),this.fightIntervals.add(Object(P.a)(Object(w.j)("swiftness",this.hero,1e3*t.cooldown)).subscribe((function(){n.store.dispatch(new g.c(Object.assign(Object.assign({},t),{isInCooldown:!1})))})))}},{key:"victory",value:function(){var t=this;this.store.dispatch(new g.p(Object(c.d)(this.hero,this.fighter,this._notifier,this.store)));var n=Object(O.c)(this.fighter.level,this.fighter.lootbag);if(null!=n)switch(n.rewardType){case"currency":this.store.dispatch(new g.k(n.reward)),this._notifier.notify(n.reward.name,"currency ".concat(n.reward.name),"reward",n.reward.quantity);break;case"armor":case"weapon":this.store.select(x.a).pipe(Object(l.a)()).subscribe((function(o){o<=0?t._notifier.notify("".concat(n.reward.quality," - ").concat(n.reward.name," "),"   \n                            ".concat(n.reward.subType," \n                            ").concat(n.reward.icon,"\n                        "),"inventoryFull"):(t.store.dispatch(new g.m(n.reward)),t._notifier.notify("".concat(n.reward.quality," - ").concat(n.reward.name),"   \n                            ".concat(n.reward.subType," \n                            ").concat(n.reward.icon,"\n                        "),"reward"))}))}else this._notifier.notify("","","noReward")}}]),t}()).\u0275fac=function(t){return new(t||i)(h.Xb(u.h),h.Xb(M.a))},i.\u0275prov=h.Kb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),m=o("XiUz"),v=o("L21D"),S=["cooldown"],j=["action"];function I(t,n){if(1&t&&h.Pb(0,"i"),2&t){var o=h.dc(2);h.Fb("",o.hero.subType," ",null==o.spell?null:o.spell.icon,""),h.Cb("data-key",o.index+1)}}function T(t,n){if(1&t&&h.Pb(0,"i"),2&t){var o=h.dc(2);h.Fb("",o.potion.subType," ",null==o.potion?null:o.potion.icon,""),h.Cb("data-key",o.index)}}function A(t,n){if(1&t&&(h.Rb(0),h.Tb(1,"div",2,3),h.Tb(3,"div",4),h.yc(4,I,1,5,"i",5),h.yc(5,T,1,5,"i",5),h.Pb(6,"canvas",6,7),h.Sb(),h.Sb(),h.Qb()),2&t){var o=h.dc();h.Bb(4),h.ic("ngIf",o.spell),h.Bb(1),h.ic("ngIf",o.potion)}}function B(t,n){if(1&t&&(h.Tb(0,"div",2,3),h.Tb(2,"div",4),h.Pb(3,"i"),h.Pb(4,"canvas",6,7),h.Sb(),h.Sb()),2&t){var o=h.dc();h.Bb(3),h.Eb("peasant ",null==o.spell?null:o.spell.icon,"")}}var $,F=(($=function(){function t(n){_classCallCheck(this,t),this.ngZone=n,this.monsterDebuff=!1,this.spellReady=new h.n}return _createClass(t,[{key:"initCooldown",value:function(t){var n=this;void 0!==this._cooldown&&this._cooldown.endCooldown(),t.isInCooldown?(this._cooldown=new L(this.ctx,this.canvas.nativeElement,t,this.action.nativeElement,("buff"===t.type||"debuff"===t.type)&&this.monsterDebuff,this.hero),this.ngZone.runOutsideAngular((function(){return n._cooldown.gaugeCooldown()}))):this.spellReady.emit(!0)}},{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.ctx=this.canvas.nativeElement.getContext("2d"),void 0!==this.spell&&this.initCooldown(this.spell)}},{key:"ngOnDestroy",value:function(){}},{key:"potion",set:function(t){this.initCooldown(t),this._potion=t},get:function(){return this._potion}}]),t}()).\u0275fac=function(t){return new(t||$)(h.Ob(h.z))},$.\u0275cmp=h.Ib({type:$,selectors:[["combat-spell-cooldown"]],viewQuery:function(t,n){var o;1&t&&(h.Fc(S,!0),h.Fc(j,!0)),2&t&&(h.oc(o=h.cc())&&(n.canvas=o.first),h.oc(o=h.cc())&&(n.action=o.first))},inputs:{index:"index",spell:"spell",potion:"potion",monsterDebuff:"monsterDebuff",hero:"hero"},outputs:{spellReady:"rdy"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["dot",""],[1,"action"],["action",""],[1,"action-internal"],[3,"class",4,"ngIf"],["width","48","height","48"],["cooldown",""]],template:function(t,n){if(1&t&&(h.yc(0,A,8,2,"ng-container",0),h.yc(1,B,6,3,"ng-template",null,1,h.zc)),2&t){var o=h.pc(2);h.ic("ngIf",!n.monsterDebuff)("ngIfElse",o)}},directives:[e.t],styles:['.peasant[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/peasantSkills.png);background-repeat:no-repeat;display:block}.peasant.peasantHearth[_ngcontent-%COMP%]{background-position:-5px -5px;width:48px;height:48px}.peasant.peasantLabor[_ngcontent-%COMP%]{background-position:-63px -5px;width:48px;height:48px}.peasant.peasantTorch[_ngcontent-%COMP%]{background-position:-5px -63px;width:48px;height:48px}.peasant.powerAttack[_ngcontent-%COMP%]{background-position:-63px -63px;width:48px;height:48px}.peasant.peasantProficiency[_ngcontent-%COMP%]{background-position:-121px -5px;width:48px;height:48px}[_nghost-%COMP%]{margin:0 1rem 2rem 0}.action[_ngcontent-%COMP%]{border:1px solid #000;border-radius:5px;box-shadow:0 2px 8px 0 #000;cursor:pointer;outline:0;position:relative;transition:.1s}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:before{font:700 .75em Roboto Condensed,sans-serif;left:.25rem;content:attr(data-key);position:absolute;text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;top:0;z-index:3}.action[_ngcontent-%COMP%]:after{bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.action.active[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]:hover{border:1px solid #fdffad;box-shadow:0 0 6px 1px #fdffad}.action[_ngcontent-%COMP%]:last-child{margin-right:0}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]{background:transparent;border-radius:5px;box-sizing:content-box;color:#fff;font-size:1.2em;overflow:hidden;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:after{box-shadow:inset 0 34px 16px -16px hsla(0,0%,100%,.4)}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:before{bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:before{box-shadow:inset 0 1px 1px -1px #fff,inset 0 2px 1px 0 hsla(0,0%,100%,.4),inset 0 -1px 2px -1px hsla(0,0%,100%,.4)}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;z-index:2}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:last-child{margin-right:0}.potion[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/potions.png);background-repeat:no-repeat;display:block}.potion.PotionIconsAdd_01[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -5px}.potion.PotionIconsAdd_02[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -5px}.potion.PotionIconsAdd_03[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -5px}.potion.PotionIconsAdd_04[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -5px}.potion.PotionIconsAdd_05[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -5px}.potion.PotionIconsAdd_06[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -5px}.potion.PotionIconsAdd_07[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -5px}.potion.PotionIconsAdd_08[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -5px}.potion.PotionIconsAdd_09[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -5px}.potion.PotionIconsAdd_10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -5px}.potion.az_bottle1[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -5px}.potion.az_bottle10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -5px}.potion.az_bottle2[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -63px}.potion.az_bottle3[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -63px}.potion.az_bottle4[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -63px}.potion.az_bottle5[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -63px}.potion.az_bottle6[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -63px}.potion.az_bottle7[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -63px}.potion.az_bottle8[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -63px}.potion.az_bottle9[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -63px}.potion.t_01[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -63px}.potion.t_02[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -63px}.potion.t_03[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -63px}.potion.t_04[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -63px}.potion.t_05[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -121px}.potion.t_06[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -121px}.potion.t_08[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -121px}.potion.t_09[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -121px}.potion.t_10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -121px}.potion.t_101[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -121px}.potion.t_102[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -121px}.potion.t_103[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -121px}.potion.t_104[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -121px}.potion.t_106[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -121px}.potion.t_108[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -121px}.potion.t_109[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -121px}.potion.t_11[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -179px}.potion.t_110[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -179px}.potion.t_111[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -179px}.potion.t_112[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -179px}.potion.t_115[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -179px}.potion.t_116[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -179px}.potion.t_117[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -179px}.potion.t_118[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -179px}.potion.t_12[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -179px}.potion.t_120[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -179px}.potion.t_122[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -179px}.potion.t_123[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -179px}.potion.t_124[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -237px}.potion.t_126[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -237px}.potion.t_127[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -237px}.potion.t_129[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -237px}.potion.t_13[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -237px}.potion.t_131[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -237px}.potion.t_132[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -237px}.potion.t_133[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -237px}.potion.t_135[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -237px}.potion.t_136[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -237px}.potion.t_138[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -237px}.potion.t_139[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -237px}.potion.t_14[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -295px}.potion.t_141[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -295px}.potion.t_142[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -295px}.potion.t_144[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -295px}.potion.t_145[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -295px}.potion.t_147[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -295px}.potion.t_148[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -295px}.potion.t_15[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -295px}.potion.t_150[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -295px}.potion.t_151[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -295px}.potion.t_153[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -295px}.potion.t_154[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -295px}.potion.t_156[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -353px}.potion.t_157[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -353px}.potion.t_159[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -353px}.potion.t_16[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -353px}.potion.t_160[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -353px}.potion.t_162[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -353px}.potion.t_163[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -353px}.potion.t_165[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -353px}.potion.t_166[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -353px}.potion.t_168[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -353px}.potion.t_169[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -353px}.potion.t_17[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -353px}.potion.t_170[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -411px}.potion.t_171[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -411px}.potion.t_172[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -411px}.potion.t_174[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -411px}.potion.t_175[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -411px}.potion.t_176[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -411px}.potion.t_178[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -411px}.potion.t_179[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -411px}.potion.t_18[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -411px}.potion.t_19[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -411px}.potion.t_20[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -411px}.potion.t_21[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -411px}.potion.t_22[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -469px}.potion.t_23[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -469px}.potion.t_24[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -469px}.potion.t_26[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -469px}.potion.t_27[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -469px}.potion.t_28[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -469px}.potion.t_29[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -469px}.potion.t_30[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -469px}.potion.t_31[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -469px}.potion.t_32[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -469px}.potion.t_34[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -469px}.potion.t_35[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -469px}.potion.t_36[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -527px}.potion.t_37[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -527px}.potion.t_38[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -527px}.potion.t_40[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -527px}.potion.t_41[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -527px}.potion.t_42[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -527px}.potion.t_44[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -527px}.potion.t_45[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -527px}.potion.t_46[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -527px}.potion.t_47[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -527px}.potion.t_49[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -527px}.potion.t_50[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -527px}.potion.t_52[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -585px}.potion.t_53[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -585px}.potion.t_54[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -585px}.potion.t_55[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -585px}.potion.t_57[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -585px}.potion.t_59[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -585px}.potion.t_60[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -585px}.potion.t_61[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -585px}.potion.t_62[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -585px}.potion.t_64[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -585px}.potion.t_65[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -585px}.potion.t_66[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -585px}.potion.t_67[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -643px}.potion.t_68[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -643px}.potion.t_69[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -643px}.potion.t_70[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -643px}.potion.t_72[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -643px}.potion.t_73[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -643px}.potion.t_74[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -643px}.potion.t_75[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -643px}.potion.t_76[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -643px}.potion.t_78[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -643px}.potion.t_79[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -643px}.potion.t_80[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -643px}.potion.t_82[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -5px}.potion.t_83[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -63px}.potion.t_85[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -121px}.potion.t_86[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -179px}.potion.t_88[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -237px}.potion.t_89[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -295px}.potion.t_90[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -353px}.potion.t_91[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -411px}.potion.t_93[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -469px}.potion.t_94[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -527px}.potion.t_95[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -585px}.potion.t_97[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -643px}.potion.t_98[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -701px}.potion.t_99[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -701px}'],changeDetection:0}),$),L=function(){function t(n,o,i,e,p,c){_classCallCheck(this,t),this.ctx=n,this.canvas=o,this.spell=i,this.element=e,this.isMonsterBuff=p,this.hero=c,this.cd=this.isMonsterBuff?Object(w.j)("swiftness",this.hero,1e3*this.spell.duration):Object(w.j)("swiftness",this.hero,1e3*this.spell.cooldown)}return _createClass(t,[{key:"clearCanvas",value:function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"endCooldown",value:function(){this.clearCanvas(),this.timer=null;var t=this.canvas,n=this.canvas.getContext("2d");n.fillStyle="rgba(253, 255, 173, 0.5)",n.fillRect(0,0,t.width,t.height),window.setTimeout((function(){n.clearRect(0,0,t.width,t.height)}),20)}},{key:"gaugeCooldown",value:function(){this.timer||this.initiateCooldown()}},{key:"initiateCooldown",value:function(){this.timer||(this.timer=window.setTimeout(this.endCooldown.bind(this),this.cd),this.timerStart=(new Date).getTime(),this.runCooldown())}},{key:"runCooldown",value:function(){if(this.timer){var t=((new Date).getTime()-this.timerStart)/this.cd*360,n=this.canvas,o=this.canvas.getContext("2d"),i=Math.sqrt(Math.pow(this.element.clientWidth,2)+Math.pow(this.element.clientHeight,2));o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,n.width,n.height),n.height=i,n.width=i,n.style.marginLeft=-i/2+"px",n.style.marginTop=-i/2+"px",o.fillStyle="rgba(0, 0, 0, 0.5)",o.translate(n.width/2,n.height/2),o.rotate(-Math.PI/2),o.beginPath(),o.moveTo(0,0),o.lineTo(i/2*Object(r.g)(Math.cos(0).toFixed(15)),i/2*Object(r.g)(Math.sin(0).toFixed(15))),o.lineWidth=2,o.strokeStyle="rgba(255, 255, 255, 0.9)",o.shadowColor="rgba(255, 255, 255, 0.6)",o.shadowBlur=10,o.stroke(),o.moveTo(0,0),o.lineTo(i/2*Object(r.g)(Math.cos(t*Math.PI/180).toFixed(15)),i/2*Object(r.g)(Math.sin(t*Math.PI/180).toFixed(15))),o.stroke(),o.shadowColor=null,o.shadowBlur=null,o.arc(0,0,i/2,t*Math.PI/180,2*Math.PI,!1),o.fill(),o.closePath(),requestAnimationFrame(this.runCooldown.bind(this))}}}]),t}();function z(t,n){if(1&t&&h.Pb(0,"combat-spell-cooldown",11),2&t){var o=n.$implicit,i=n.index,e=h.dc();h.ic("spell",o)("index",i)("hero",e.hero)("monsterDebuff",!0)}}var D,R=((D=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"healthPercentage",value:function(t){return Math.round(t.hp/t.maxHp*100)}},{key:"trackByFn",value:function(t,n){return n}},{key:"rewardExp",value:function(){return Object(c.e)(this.heroLevel,this.heroLevel-this.fighter.level)}},{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||D)},D.\u0275cmp=h.Ib({type:D,selectors:[["app-combat-monster-hud"]],inputs:{fighter:"fighter",hero:"hero",heroLevel:"heroLevel"},decls:26,vars:14,consts:[["fxLayout","column","fxLayoutAlign","center center"],[1,"combat"],["cardHeader",""],["cardBody",""],["fxLayout","row nowrap"],["fxLayout","column","fxLayoutAlign","space-evenly","fxFlex","grow",1,"stat"],["fxLayout","row","fxLayoutAlign","space-around center"],[1,"myProgress","hp"],[1,"fillingBar"],["fxLayout","row"],["style","transform: scale(0.5);",3,"spell","index","hero","monsterDebuff",4,"ngFor","ngForOf","ngForTrackBy"],[2,"transform","scale(0.5)",3,"spell","index","hero","monsterDebuff"]],template:function(t,n){1&t&&(h.Tb(0,"div",0),h.Tb(1,"app-card",1),h.Rb(2,2),h.Ac(3),h.Qb(),h.Rb(4,3),h.Tb(5,"div",4),h.Tb(6,"div"),h.Pb(7,"i"),h.Sb(),h.Tb(8,"div",5),h.Tb(9,"div",6),h.Tb(10,"label"),h.Ac(11),h.Sb(),h.Tb(12,"label"),h.Ac(13),h.Sb(),h.Sb(),h.Tb(14,"div",6),h.Tb(15,"label"),h.Ac(16),h.Sb(),h.Tb(17,"label"),h.Ac(18),h.Sb(),h.Sb(),h.Sb(),h.Sb(),h.Tb(19,"div"),h.Tb(20,"div",7),h.Tb(21,"span"),h.Ac(22),h.Sb(),h.Pb(23,"div",8),h.Sb(),h.Tb(24,"div",9),h.yc(25,z,1,4,"combat-spell-cooldown",10),h.Sb(),h.Sb(),h.Qb(),h.Sb(),h.Sb()),2&t&&(h.Bb(3),h.Dc(" ",n.fighter.name," / lvl ",n.fighter.level," "),h.Bb(4),h.Eb("",n.fighter.icon," mob"),h.Bb(4),h.Cc(" Attack : ",n.fighter.attack,""),h.Bb(2),h.Cc(" Defense : ",n.fighter.defense,""),h.Bb(3),h.Cc(" Attack speed : ",n.fighter.attackSpeed/1e3,"/s"),h.Bb(2),h.Cc(" Exp : ",n.rewardExp(),""),h.Bb(4),h.Cc(" ",n.fighter.hp,""),h.Bb(1),h.xc("width",n.healthPercentage(n.fighter),"%"),h.Bb(2),h.ic("ngForOf",null==n.fighter?null:n.fighter.debuffs)("ngForTrackBy",n.trackByFn))},directives:[m.f,m.e,v.a,m.b,e.s,F],styles:[".myProgress[_ngcontent-%COMP%]{display:flex;position:relative;font-size:small;height:30px;width:inherit}.myProgress.mana[_ngcontent-%COMP%]{height:20px;box-shadow:1px 1px 2px #3a529c,-1px -1px 2px #3a529c}.myProgress.mana[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:chambray;transition:width 1s;border-radius:inherit}.myProgress.mana[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #3a529c,-1px -1px 4px #3a529c}.myProgress.hp[_ngcontent-%COMP%]{box-shadow:1px 1px 2px #26a65b,-1px -1px 2px #26a65b}.myProgress.hp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:#26a65b;border-radius:inherit;transition:width 1s}.myProgress.hp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #26a65b,-1px -1px 4px #26a65b}.myProgress.exp[_ngcontent-%COMP%]{width:100%;margin-top:10px;height:15px;box-shadow:1px 1px 2px #f15a22,-1px -1px 2px #f15a22}.myProgress.exp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;background-color:#f15a22;transition:width 1s}.myProgress.exp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #f15a22,-1px -1px 4px #f15a22}.myProgress.miscellaneous[_ngcontent-%COMP%]{height:15px;margin-top:2px;box-shadow:1px 1px 2px orange,-1px -1px 2px orange}.myProgress.miscellaneous[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;transition:width 1s}.myProgress.miscellaneous[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px orange,-1px -1px 4px orange}.myProgress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.mob[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/mobs.png);background-repeat:no-repeat;display:block}.mob.gobelino[_ngcontent-%COMP%]{background-position:-5px -5px;width:128px;height:128px}.mob.goboss[_ngcontent-%COMP%]{background-position:-143px -5px;width:128px;height:128px}.mob.creepyBuddy[_ngcontent-%COMP%]{background-position:-281px -5px;width:128px;height:128px}.mob.demon[_ngcontent-%COMP%]{background-position:-5px -143px;width:128px;height:128px}.mob.babyDragon[_ngcontent-%COMP%]{background-position:-143px -143px;width:128px;height:128px}.mob.dummy[_ngcontent-%COMP%]{background-position:-281px -143px}.mob.dummy[_ngcontent-%COMP%], .mob.joker[_ngcontent-%COMP%]{width:128px;height:128px}.mob.joker[_ngcontent-%COMP%]{background-position:-5px -281px}.mob.piggy[_ngcontent-%COMP%]{background-position:-143px -281px}.mob.piggy[_ngcontent-%COMP%], .mob.sheepy[_ngcontent-%COMP%]{width:128px;height:128px}.mob.sheepy[_ngcontent-%COMP%]{background-position:-281px -281px}.mob.froggy[_ngcontent-%COMP%]{background-position:-419px -5px;width:128px;height:128px}.stat[_ngcontent-%COMP%]{height:10vh}"]}),D),E=o("XNiG"),H=o("zp1y"),q=o("++hd");function X(t,n){if(1&t){var o=h.Ub();h.Tb(0,"combat-spell-cooldown",11),h.bc("rdy",(function(t){return h.rc(o),h.dc().casted(t)}))("click",(function(){h.rc(o);var t=n.$implicit;return h.dc().doCastSpell$.next({spell:t,hotKey:""})})),h.ec(1,"async"),h.Sb()}if(2&t){var i=n.$implicit,e=n.index,p=h.dc();h.ic("tooltip",i)("tooltip-detach",p.spellCasted)("tooltip-type","spell")("spell",i)("index",e)("hero",h.fc(1,6,p.hero$))}}function Q(t,n){if(1&t){var o=h.Ub();h.Tb(0,"combat-spell-cooldown",12),h.bc("rdy",(function(t){return h.rc(o),h.dc().casted(t)}))("click",(function(){h.rc(o);var t=n.ngIf;return h.dc().doUsePotion$.next({potion:t})})),h.ec(1,"async"),h.ec(2,"async"),h.Sb()}if(2&t){var i=n.ngIf,e=h.dc();h.ic("tooltip",i)("tooltip-detach",e.spellCasted)("potion",h.fc(1,5,e.potion$))("index",5)("hero",h.fc(2,7,e.hero$))}}var K,U,Y,V=((U=function(){function t(n){var o=this;_classCallCheck(this,t),this.store=n,this.hero$=this.store.select(x.f),this.castSpell=new h.n,this.spellCasted=new h.n,this.healthPercentage$=this.hero$.pipe(Object(p.a)((function(t){return t?Math.round(t.hp/t.maxHp*100):0}))),this.expPercentage$=this.hero$.pipe(Object(p.a)((function(t){return t?Math.round(t.exp/o.getXPForLevel(t.level)*100):0}))),this.potion$=this.hero$.pipe(Object(p.a)((function(t){return t.potion}))),this.doCastSpell$=new E.a,this._castSpellSubscription=this.doCastSpell$.pipe(Object(H.a)(this.hero$,(function(t,n){if(""!=t.hotKey)n.equippedSpell.forEach((function(n,i){t.hotKey===(i+1).toString()&&(n.isInCooldown||(o.castSpell.emit(n),o.casted(!0)))}));else{if(t.spell.isInCooldown)return;o.castSpell.emit(t.spell),o.casted(!0)}}))).subscribe(),this.doUsePotion$=new E.a,this._usePotionSubscription=this.doUsePotion$.pipe(Object(H.a)(this.hero$,(function(t,n){t.potion.isInCooldown||(o.castSpell.emit(t.potion),o.spellCasted.emit(!0))}))).subscribe()}return _createClass(t,[{key:"casted",value:function(t){this.spellCasted.emit(t)}},{key:"cast",value:function(t){var n="";"keydown"==event.type&&(n=String.fromCharCode(event.keyCode)),this.doCastSpell$.next({spell:t,hotKey:n})}},{key:"getXPForLevel",value:function(t){return Object(c.b)(t)}},{key:"trackByFn",value:function(t,n){return n}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this._castSpellSubscription.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||U)(h.Ob(u.h))},U.\u0275cmp=h.Ib({type:U,selectors:[["app-combat-hero-hud"]],hostBindings:function(t,n){1&t&&h.bc("keydown",(function(){return n.cast()}),!1,h.qc)},outputs:{castSpell:"castSpell",spellCasted:"spellCasted"},decls:27,vars:30,consts:[["fxLayout","row","fxLayoutAlign","center center",1,"ui-container"],[1,"combat"],["cardHeader",""],["cardBody",""],[1,"myProgress","hp"],[1,"fillingBar"],[1,"myProgress","exp"],["cardFooter",""],["fxLayout","row","fxLayoutAlign","center center"],[3,"tooltip","tooltip-detach","tooltip-type","spell","index","hero","rdy","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"tooltip","tooltip-detach","potion","index","hero","rdy","click",4,"ngIf"],[3,"tooltip","tooltip-detach","tooltip-type","spell","index","hero","rdy","click"],[3,"tooltip","tooltip-detach","potion","index","hero","rdy","click"]],template:function(t,n){1&t&&(h.Tb(0,"div",0),h.Tb(1,"app-card",1),h.Rb(2,2),h.Ac(3),h.ec(4,"async"),h.Qb(),h.Rb(5,3),h.Tb(6,"div"),h.Tb(7,"div",4),h.Tb(8,"span"),h.Ac(9),h.ec(10,"async"),h.ec(11,"async"),h.Sb(),h.Tb(12,"div",5),h.ec(13,"async"),h.Sb(),h.Sb(),h.Tb(14,"div",6),h.Tb(15,"span"),h.Ac(16),h.ec(17,"async"),h.ec(18,"async"),h.Sb(),h.Tb(19,"div",5),h.ec(20,"async"),h.Sb(),h.Sb(),h.Sb(),h.Qb(),h.Rb(21,7),h.Tb(22,"div",8),h.yc(23,X,2,8,"combat-spell-cooldown",9),h.ec(24,"async"),h.yc(25,Q,3,9,"combat-spell-cooldown",10),h.ec(26,"async"),h.Sb(),h.Qb(),h.Sb(),h.Sb()),2&t&&(h.Bb(3),h.Cc(" You / lvl ",h.fc(4,12,n.hero$).level," "),h.Bb(6),h.Dc(" ",h.fc(10,14,n.hero$).hp," / ",h.fc(11,16,n.hero$).maxHp,""),h.Bb(3),h.xc("width",h.fc(13,18,n.healthPercentage$),"%"),h.Bb(4),h.Dc(" ",h.fc(17,20,n.hero$).exp," / ",n.getXPForLevel(h.fc(18,22,n.hero$).level),""),h.Bb(3),h.xc("width",h.fc(20,24,n.expPercentage$),"%"),h.Bb(4),h.ic("ngForOf",h.fc(24,26,n.hero$).equippedSpell)("ngForTrackBy",n.trackByFn),h.Bb(2),h.ic("ngIf",h.fc(26,28,n.potion$)))},directives:[m.f,m.e,v.a,e.s,e.t,F,q.a],pipes:[e.b],styles:[".myProgress[_ngcontent-%COMP%]{display:flex;position:relative;font-size:small;height:30px;width:inherit}.myProgress.mana[_ngcontent-%COMP%]{height:20px;box-shadow:1px 1px 2px #3a529c,-1px -1px 2px #3a529c}.myProgress.mana[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:chambray;transition:width 1s;border-radius:inherit}.myProgress.mana[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #3a529c,-1px -1px 4px #3a529c}.myProgress.hp[_ngcontent-%COMP%]{box-shadow:1px 1px 2px #26a65b,-1px -1px 2px #26a65b}.myProgress.hp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:#26a65b;border-radius:inherit;transition:width 1s}.myProgress.hp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #26a65b,-1px -1px 4px #26a65b}.myProgress.exp[_ngcontent-%COMP%]{width:100%;margin-top:10px;height:15px;box-shadow:1px 1px 2px #f15a22,-1px -1px 2px #f15a22}.myProgress.exp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;background-color:#f15a22;transition:width 1s}.myProgress.exp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #f15a22,-1px -1px 4px #f15a22}.myProgress.miscellaneous[_ngcontent-%COMP%]{height:15px;margin-top:2px;box-shadow:1px 1px 2px orange,-1px -1px 2px orange}.myProgress.miscellaneous[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;transition:width 1s}.myProgress.miscellaneous[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px orange,-1px -1px 4px orange}.myProgress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;bottom:0;width:100vw}.ui-container[_ngcontent-%COMP%]{width:500px}.ui-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px;width:48px;height:48px;box-shadow:0 0 1px .5px #fff}"]}),U),W=((K=function(){function t(n,o,i,e){_classCallCheck(this,t),this.store=n,this.route=o,this.combatService=i,this.router=e,this.hero$=this.store.select(x.f),this.city$=this.store.select(Object(s.b)(this.route.snapshot.paramMap.get("cityId")))}return _createClass(t,[{key:"activateSpell",value:function(t){"item"==t.type?this.combatService.usePotion(t):this.combatService.activateSpell(t)}},{key:"ngOnInit",value:function(){var t=this,n=a.m.get(this.route.snapshot.paramMap.get("monster"));this.city$.pipe(Object(d.a)(1)).subscribe((function(o){var i=o.building.find((function(t){return"huntingPost"==t.type})).actions.find((function(t){return t.targetId===n.eid})).currentLevel;t.fighter=Object(b.a)(n,i)})),this.combatService.fighter=this.fighter,this.subscription=this.hero$.subscribe((function(n){return t.combatService.initialize(n)}))}},{key:"ngOnDestroy",value:function(){var t=this;this.hero$.pipe(Object(l.a)()).subscribe((function(n){return t.store.dispatch(new g.p(Object.assign(Object.assign({},n),{hp:n.maxHp})))})),this.subscription.unsubscribe(),this.combatService.stop()}}]),t}()).\u0275fac=function(t){return new(t||K)(h.Ob(u.h),h.Ob(_.a),h.Ob(y),h.Ob(_.f))},K.\u0275cmp=h.Ib({type:K,selectors:[["app-combat"]],decls:5,vars:7,consts:[["fxLayout","row nowrap","fxLayoutAlign","center center"],[3,"fighter","hero","heroLevel"],[3,"castSpell"]],template:function(t,n){1&t&&(h.Tb(0,"div",0),h.Pb(1,"app-combat-monster-hud",1),h.ec(2,"async"),h.ec(3,"async"),h.Sb(),h.Tb(4,"app-combat-hero-hud",2),h.bc("castSpell",(function(t){return n.activateSpell(t)})),h.Sb()),2&t&&(h.Bb(1),h.ic("fighter",n.fighter)("hero",h.fc(2,3,n.hero$))("heroLevel",h.fc(3,5,n.hero$).level))},directives:[m.f,m.e,R,V],pipes:[e.b],styles:[""]}),K),J=o("PCNd"),N=((Y=function t(){_classCallCheck(this,t)}).\u0275mod=h.Mb({type:Y}),Y.\u0275inj=h.Lb({factory:function(t){return new(t||Y)},imports:[[e.c,J.a,_.i.forChild([{path:"",component:W}])]]}),Y)}}]);