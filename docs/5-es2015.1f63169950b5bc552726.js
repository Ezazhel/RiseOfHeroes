(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{AH38:function(t,e,n){"use strict";n.r(e),n.d(e,"CityModule",(function(){return L}));var o=n("cLqD"),i=n("PCNd"),c=n("tyNb"),s=n("ofXK"),r=n("kt0X");const a=Object(r.o)("cities");var p=n("lJxs"),l=n("fXoL"),b=n("sYnD"),u=n("YMgP"),h=n("Mpt7");let d=(()=>{class t{constructor(t){this.store=t}renewShopItem(t=this.cityId,e){this.store.dispatch(new u.e({city:t,shopType:e.type,items:this.renewByType(e.type)}))}renewByType(t){switch(t){case"blacksmith":return Object(h.a)([["armor1",{id:"armor1",name:"Armor",value:2,level:1,icon:"armor",type:"armor",subType:"chest",armor:5,style:"rare"}],["armor2",{id:"armor2",name:"Gauntlet",value:1,level:1,icon:"armor",type:"armor",subType:"chest",armor:5,style:"common"}],["armor3",{id:"armor31",name:"Armor",value:2,level:1,icon:"armor",type:"armor",subType:"chest",armor:5,style:"rare"}],["armor41",{id:"armor41",name:"Armor",value:2,level:1,icon:"armor",type:"armor",subType:"chest",armor:5,style:"rare"}],["armor51",{id:"armor51",name:"Armor",value:2,level:1,icon:"armor",type:"armor",subType:"chest",armor:5,style:"rare"}]]);case"alchemist":return Object(h.a)([["item1",{id:"item1",name:"Health Potion",value:150,level:0,icon:"potionRed",type:"item",style:""}],["item21",{id:"item21",name:"Health Potion",value:150,level:0,icon:"potionRed",type:"item",style:""}],["item2",{id:"item2",name:"Mana Potion",value:150,level:0,icon:"potionBlue",type:"item",style:""}],["item23",{id:"item23",name:"Mana Potion",value:150,level:0,icon:"potionBlue",type:"item",style:""}]])}}buyItem(t,e,n){this.store.dispatch(new u.d({item:t,shopType:e,city:n})),this.store.dispatch(new b.n({name:"gold",quantity:-t.value})),this.store.dispatch(new b.o(t))}sellItem(t,e,n){this.store.dispatch(new u.f({item:t,shopType:e,city:n})),this.store.dispatch(new b.n({name:"gold",quantity:t.value})),this.store.dispatch(new b.p(t.id))}}return t.\u0275fac=function(e){return new(e||t)(l.Wb(r.h))},t.\u0275prov=l.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var g=n("XiUz"),m=n("znSr");const y=function(t){return{active:t}};function f(t,e){if(1&t){const t=l.Tb();l.Sb(0,"button",1),l.ac("click",(function(){return l.qc(t),l.cc().selectTab("craft")})),l.yc(1," Craft "),l.Rb()}if(2&t){const t=l.cc();l.ic("ngClass",l.mc(1,y,"craft"===t.activeTab))}}function v(t,e){if(1&t){const t=l.Tb();l.Sb(0,"button",1),l.ac("click",(function(){return l.qc(t),l.cc().selectTab("update")})),l.yc(1," Upgrade "),l.Rb()}if(2&t){const t=l.cc();l.ic("ngClass",l.mc(1,y,"update"===t.activeTab))}}let w=(()=>{class t{constructor(){this.selectedTab=new l.n,this.activeTab="shop"}selectTab(t){this.activeTab=t,this.selectedTab.emit(t)}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Hb({type:t,selectors:[["app-city-shop-tab"]],inputs:{shop:"shop"},outputs:{selectedTab:"selectedTab"},decls:7,vars:6,consts:[["fxLayout","row nowrap",1,"tab"],[3,"ngClass","click"],[3,"ngClass","click",4,"ngIf"]],template:function(t,e){1&t&&(l.Sb(0,"div",0),l.Sb(1,"button",1),l.ac("click",(function(){return e.selectTab("shop")})),l.yc(2," Shop "),l.Rb(),l.wc(3,f,2,3,"button",2),l.wc(4,v,2,3,"button",2),l.Sb(5,"span"),l.yc(6),l.Rb(),l.Rb()),2&t&&(l.Bb(1),l.ic("ngClass",l.mc(4,y,"shop"===e.activeTab)),l.Bb(2),l.ic("ngIf",void 0!==e.shop.crafts),l.Bb(1),l.ic("ngIf",void 0!==(null==e.shop?null:e.shop.upgrades)),l.Bb(2),l.Ac(" ",e.shop.name," "))},directives:[g.b,s.j,m.a,s.l],styles:[".tab[_ngcontent-%COMP%]{height:25px;color:#f2f2f2;background:#91a0ca}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:inherit;background:#3b5888;color:#f2f1ef;border:none;outline:none;cursor:pointer;-webkit-transition:.3s;transition:.3s;font-size:small}.tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:rgba(59,88,136,.65)}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:rgba(189,182,67,.75);color:#2e3131}.tab[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:hover{background:#bdb643}.tab[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{margin-left:auto;margin-right:10px;align-self:center}"]}),t})();var x=n("QPBi"),k=n("AB2Y"),O=n("PqYM"),I=n("cOoP");function C(t,e){if(1&t&&(l.Sb(0,"span"),l.yc(1),l.Rb()),2&t){const t=l.cc();l.Bb(1),l.Ac("Shop reset in ",t.timer,"")}}function _(t,e){if(1&t){const t=l.Tb();l.Sb(0,"button",8),l.ac("click",(function(){l.qc(t);const e=l.cc().$implicit;return l.cc().buyItem(e[1])})),l.yc(1," Buy "),l.Rb()}}function M(t,e){if(1&t){const t=l.Tb();l.Sb(0,"div",3),l.ac("mouseenter",(function(){l.qc(t);const n=e.$implicit;return l.cc().setItem(n[1])}))("mouseleave",(function(){return l.qc(t),l.cc().setItem(null)})),l.Ob(1,"i"),l.Sb(2,"span",4),l.yc(3),l.Rb(),l.Sb(4,"div",5),l.Sb(5,"span",6),l.yc(6),l.Rb(),l.wc(7,_,2,0,"button",7),l.dc(8,"async"),l.Rb(),l.Rb()}if(2&t){const t=e.$implicit,o=l.cc();var n=null;const i=t[1].value<=(null==(n=l.ec(8,9,o._currencies$))?null:n.get("gold").quantity);l.Eb("content ",t[1].style,""),l.Bb(1),l.Eb("sprite sprite-",t[1].icon," "),l.Bb(2),l.Ac(" ",t[1].name," "),l.Bb(3),l.Ac(" ",t[1].value,"g "),l.Bb(1),l.ic("ngIf",i)}}let P=(()=>{class t{constructor(t,e,n){this.store=t,this.shopService=e,this.transloco=n,this.onSetItem=new l.n,this._previousSecond=0,this._currencies$=this.store.pipe(Object(r.r)(I.a))}set shop(t){this._shop=t}buyItem(t){this.shopService.buyItem(t,this._shop.type,this.cityId)}renew(t){null!=this.minutes&&this.minutes.unsubscribe();const e=new Intl.NumberFormat(this.transloco.getActiveLang(),{maximumSignificantDigits:2,minimumIntegerDigits:2}),n=performance.now();let o=(n-t.lastTick)/1e3/t.intervalStock,i=(n-t.lastTick)/1e3%t.intervalStock,c=t.intervalStock-i-this._previousSecond;c=Math.round(c),this.minutes=Object(O.a)(0,1e3).subscribe(n=>{this.timer=`${e.format(Math.floor(c/60))} : ${e.format(Math.floor(c%60))}`,--c,(c<0||o>=1)&&(this._previousSecond=o>=1?i:0,this.shopService.renewShopItem(this.cityId,t),this.minutes.unsubscribe())})}setItem(t){this.onSetItem.emit(t)}trackByFn(t,e){return t}ngOnInit(){}ngOnChanges(t){var e,n,o;const i=t.shop.previousValue,c=t.shop.currentValue;t.shop.firstChange||(null===(e=i)||void 0===e?void 0:e.type)!=c.type?(this._previousSecond=0,void 0!==this._shop.intervalStock&&this.renew(this._shop)):(null===(n=i)||void 0===n?void 0:n.type)===c.type&&(null===(o=i)||void 0===o?void 0:o.lastTick)!==c.lastTick&&this.renew(this._shop)}ngOnDestroy(){this.minutes.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(r.h),l.Nb(d),l.Nb(x.e))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-city-shop-content-shop"]],inputs:{cityId:"cityId",shop:"shop"},outputs:{onSetItem:"onSetItem"},features:[l.zb()],decls:3,vars:3,consts:[["fxLayout","column"],[4,"ngIf"],[3,"class","mouseenter","mouseleave",4,"ngFor","ngForOf","ngForTrackBy"],[3,"mouseenter","mouseleave"],[1,"item-name"],[1,"action"],[1,"item-value"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(l.Sb(0,"div",0),l.wc(1,C,2,1,"span",1),l.wc(2,M,9,11,"div",2),l.Rb()),2&t&&(l.Bb(1),l.ic("ngIf",void 0!==e._shop.intervalStock),l.Bb(1),l.ic("ngForOf",e._shop.items)("ngForTrackBy",e.trackByFn))},directives:[g.b,s.l,s.k],pipes:[s.b],styles:[".sprite[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/lootequipment.png);background-repeat:no-repeat;display:block}.sprite-armor[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -5px}.sprite-axe[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -5px}.sprite-bow[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -5px}.sprite-dagger[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -63px}.sprite-helmet[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -63px}.sprite-potionBlue[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -63px}.sprite-potionRed[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -121px}.sprite-shield[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -121px}.sprite-sword[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -121px}.content[_ngcontent-%COMP%]{display:-webkit-box;display:flex;height:50px;min-width:30vw;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;box-shadow:0 .2rem .15rem #789;box-sizing:border-box;margin:5px 0;border:1px solid #789;background:#fff;padding-right:5px;color:#1f2025;font-weight:700}.content.rare[_ngcontent-%COMP%]{box-shadow:0 .2rem .15rem #4282d7;color:#4282d7}.content.common[_ngcontent-%COMP%]{box-shadow:0 .2rem .15rem #23e006;color:#23e006}.content[_ngcontent-%COMP%]   span.item-name[_ngcontent-%COMP%]{vertical-align:middle}.content[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;text-align:center}.content[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   span.item-value[_ngcontent-%COMP%]{font-size:x-small;color:#1f2025}.content[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;outline:none;cursor:pointer;height:25px;-webkit-transition:.3s;transition:.3s;font-size:small;border-radius:10px}.content[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#aab6b6}"]}),t})();function S(t,e){if(1&t){const t=l.Tb();l.Qb(0),l.Sb(1,"app-city-shop-content-shop",5),l.ac("onSetItem",(function(e){return l.qc(t),l.cc(),l.pc(3).setItem(e)})),l.Rb(),l.Pb()}if(2&t){const t=l.cc(2);l.Bb(1),l.ic("shop",t._shop)("cityId",t.cityId)}}function T(t,e){if(1&t){const t=l.Tb();l.Sb(0,"div",1),l.wc(1,S,2,2,"ng-container",2),l.Sb(2,"app-inventory-slot",3,4),l.ac("sell",(function(e){return l.qc(t),l.cc().sellItem(e)})),l.Rb(),l.Rb()}if(2&t){const t=l.cc();l.Bb(1),l.ic("ngIf","shop"===t.displayedContent),l.Bb(1),l.ic("selling",!0)}}let B=(()=>{class t{constructor(t,e,n){this.store=t,this.shopService=e,this.transloco=n}set shop(t){this._shop=t}sellItem(t){switch(this._shop.acceptType){case"consumable":"item"===t.type?this.shopService.sellItem(t,this._shop.type,this.cityId):alert("You can't sell this here");break;case"equipment":"armor"===t.type||"weapon"===t.type?this.shopService.sellItem(t,this._shop.type,this.cityId):alert("You can't sell this here")}}trackByFn(t,e){return t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(r.h),l.Nb(d),l.Nb(x.e))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-city-shop-content"]],inputs:{cityId:"cityId",displayedContent:"displayedContent",shop:"shop"},decls:1,vars:1,consts:[["fxLayout","row","fxLayoutAlign","space-between",4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between"],[4,"ngIf"],[3,"selling","sell"],["inventory",""],[3,"shop","cityId","onSetItem"]],template:function(t,e){1&t&&l.wc(0,T,4,2,"div",0),2&t&&l.ic("ngIf",e._shop)},directives:[s.l,g.b,g.a,k.a,P],styles:[""]}),t})();function R(t,e){if(1&t){const t=l.Tb();l.Sb(0,"div",1),l.Sb(1,"app-city-shop-tab",2),l.ac("selectedTab",(function(e){return l.qc(t),l.cc().displayedContent=e})),l.Rb(),l.Ob(2,"app-city-shop-content",3),l.Rb()}if(2&t){const t=e.ngIf,n=l.cc();l.Bb(1),l.ic("shop",t),l.Bb(1),l.ic("displayedContent",n.displayedContent)("shop",t)("cityId",n.cityId)}}let $=(()=>{class t{constructor(){this.displayedContent="shop"}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Hb({type:t,selectors:[["app-city-shop"]],inputs:{shop$:["shop","shop$"],cityId:"cityId"},decls:2,vars:3,consts:[["class","shop-ui",4,"ngIf"],[1,"shop-ui"],[3,"shop","selectedTab"],[3,"displayedContent","shop","cityId"]],template:function(t,e){1&t&&(l.wc(0,R,3,4,"div",0),l.dc(1,"async")),2&t&&l.ic("ngIf",l.ec(1,1,e.shop$))},directives:[s.l,w,B],pipes:[s.b],styles:[".shop-ui[_ngcontent-%COMP%]{box-shadow:0 0 2px 2px #95a6a7;padding:5px;min-width:30vw;min-height:50vh}"]}),t})();const q=function(t){return{active:t}};function F(t,e){if(1&t){const t=l.Tb();l.Sb(0,"button",5),l.ac("click",(function(){l.qc(t);const n=e.$implicit;return l.cc(2).setShop(n[1])})),l.dc(1,"async"),l.yc(2),l.Rb()}if(2&t){const t=e.$implicit,o=l.cc(2);var n;const i=l.mc(4,q,t[1].type===(null==(n=l.ec(1,2,o.shop$))?null:n.type));l.ic("ngClass",i),l.Bb(2),l.Ac(" ",t[1].name," ")}}function A(t,e){if(1&t&&(l.Sb(0,"div",1),l.Sb(1,"h1"),l.yc(2),l.Rb(),l.Sb(3,"p"),l.yc(4),l.Rb(),l.Sb(5,"div",2),l.wc(6,F,3,6,"button",3),l.Rb(),l.Ob(7,"app-city-shop",4),l.Rb()),2&t){const t=e.ngIf,n=l.cc();l.Bb(2),l.zc(t.name),l.Bb(2),l.zc(null==t?null:t.description),l.Bb(2),l.ic("ngForOf",t.shops)("ngForTrackBy",n.trackByFn),l.Bb(1),l.ic("shop",n.shop$)("cityId",t.id)}}let j=(()=>{class t{constructor(t,e,n){var o;this.route=t,this.store=e,this.shopService=n,this.city$=this.store.pipe(Object(r.r)((o=this.route.snapshot.paramMap.get("cityId"),Object(r.p)(a,t=>t.cities.get(o))))),this.shopService.cityId=this.route.snapshot.paramMap.get("cityId")}setShop(t){this.shop$=this.city$.pipe(Object(p.a)(e=>e.shops.get(t.type)))}trackByFn(t,e){return t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(l.Nb(c.a),l.Nb(r.h),l.Nb(d))},t.\u0275cmp=l.Hb({type:t,selectors:[["app-city"]],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],["fxLayout","row nowrap","fxLayoutAlign","center center"],[3,"ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"shop","cityId"],[3,"ngClass","click"]],template:function(t,e){1&t&&(l.wc(0,A,8,6,"div",0),l.dc(1,"async")),2&t&&l.ic("ngIf",l.ec(1,1,e.city$))},directives:[s.l,g.b,g.a,s.k,$,s.j,m.a],pipes:[s.b],styles:[".container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}button[_ngcontent-%COMP%]{height:25px;margin:5px;background:#3b5888;border:none;outline:none;cursor:pointer;-webkit-transition:.3s;transition:.3s;color:#f2f1ef;font-size:small}button[_ngcontent-%COMP%]:hover{background:rgba(59,88,136,.65)}button.active[_ngcontent-%COMP%]{background:rgba(189,182,67,.75);color:#2e3131}button.active[_ngcontent-%COMP%]:hover{background:#bdb643}"]}),t})(),L=(()=>{class t{}return t.\u0275mod=l.Lb({type:t}),t.\u0275inj=l.Kb({factory:function(e){return new(e||t)},imports:[[s.c,i.a,o.a,c.i.forChild([{path:":cityId",component:j}])]]}),t})()}}]);