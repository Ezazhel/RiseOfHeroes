(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{OVhx:function(t,o,n){"use strict";n.r(o),n.d(o,"CombatModule",(function(){return R}));var i=n("ofXK"),p=(n("2Vo4"),n("lJxs")),e=n("QuZ5"),x=n("fXoL"),h=n("QPBi"),g=n("4Y61"),c=n("DcRq"),s=n("cOoP"),d=n("sYnD"),a=n("IzEk"),r=n("SxV6"),b=n("IM8C"),_=n("kt0X"),u=n("tyNb"),l=n("HkPj"),P=n("XiUz"),C=n("L21D"),O=n("EQES");const w=["cooldown"],M=["action"];function k(t,o){if(1&t&&x.Pb(0,"i"),2&t){const t=x.dc(2);x.Fb("",t.hero.subType," ",null==t.spell?null:t.spell.icon,""),x.Cb("data-key",t.index+1)}}function m(t,o){if(1&t&&x.Pb(0,"i"),2&t){const t=x.dc(2);x.Fb("",t.potion.subType," ",null==t.potion?null:t.potion.icon,""),x.Cb("data-key",t.index)}}function f(t,o){if(1&t&&(x.Rb(0),x.Tb(1,"div",2,3),x.Tb(3,"div",4),x.yc(4,k,1,5,"i",5),x.yc(5,m,1,5,"i",5),x.Pb(6,"canvas",6,7),x.Sb(),x.Sb(),x.Qb()),2&t){const t=x.dc();x.Bb(4),x.ic("ngIf",t.spell),x.Bb(1),x.ic("ngIf",t.potion)}}function y(t,o){if(1&t&&(x.Tb(0,"div",2,3),x.Tb(2,"div",4),x.Pb(3,"i"),x.Pb(4,"canvas",6,7),x.Sb(),x.Sb()),2&t){const t=x.dc();x.Bb(3),x.Eb("peasant ",null==t.spell?null:t.spell.icon,"")}}let v=(()=>{class t{constructor(t){this.ngZone=t,this.isNotDebuff=!0,this.spellReady=new x.n}set potion(t){this.initCooldown(t),this._potion=t}get potion(){return this._potion}initCooldown(t){void 0!==this._cooldown&&this._cooldown.endCooldown(),t.isInCooldown?(this._cooldown=new S(this.ctx,this.canvas.nativeElement,t,this.action.nativeElement,this.isNotDebuff,this.hero),this.ngZone.runOutsideAngular(()=>this._cooldown.gaugeCooldown())):this.spellReady.emit(!0)}ngOnInit(){}ngAfterViewInit(){this.ctx=this.canvas.nativeElement.getContext("2d"),void 0!==this.spell&&this.initCooldown(this.spell)}ngOnDestroy(){}}return t.\u0275fac=function(o){return new(o||t)(x.Ob(x.z))},t.\u0275cmp=x.Ib({type:t,selectors:[["combat-spell-cooldown"]],viewQuery:function(t,o){var n;1&t&&(x.Fc(w,!0),x.Fc(M,!0)),2&t&&(x.oc(n=x.cc())&&(o.canvas=n.first),x.oc(n=x.cc())&&(o.action=n.first))},inputs:{index:"index",spell:"spell",potion:"potion",isNotDebuff:"isNotDebuff",hero:"hero"},outputs:{spellReady:"rdy"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["dot",""],[1,"action"],["action",""],[1,"action-internal"],[3,"class",4,"ngIf"],["width","48","height","48"],["cooldown",""]],template:function(t,o){if(1&t&&(x.yc(0,f,8,2,"ng-container",0),x.yc(1,y,6,3,"ng-template",null,1,x.zc)),2&t){const t=x.pc(2);x.ic("ngIf",o.isNotDebuff)("ngIfElse",t)}},directives:[i.t],styles:['.peasant[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/peasantSkills.png);background-repeat:no-repeat;display:block}.peasant.peasantHearth[_ngcontent-%COMP%]{background-position:-5px -5px;width:48px;height:48px}.peasant.peasantLabor[_ngcontent-%COMP%]{background-position:-63px -5px;width:48px;height:48px}.peasant.peasantTorch[_ngcontent-%COMP%]{background-position:-5px -63px;width:48px;height:48px}.peasant.powerAttack[_ngcontent-%COMP%]{background-position:-63px -63px;width:48px;height:48px}[_nghost-%COMP%]{margin:0 1rem 2rem 0}.action[_ngcontent-%COMP%]{border:1px solid #000;border-radius:5px;box-shadow:0 2px 8px 0 #000;cursor:pointer;outline:0;position:relative;transition:.1s}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:before{font:700 .75em Roboto Condensed,sans-serif;left:.25rem;content:attr(data-key);position:absolute;text-shadow:-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000;top:0;z-index:3}.action[_ngcontent-%COMP%]:after{bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.action.active[_ngcontent-%COMP%], .action[_ngcontent-%COMP%]:hover{border:1px solid #fdffad;box-shadow:0 0 6px 1px #fdffad}.action[_ngcontent-%COMP%]:last-child{margin-right:0}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]{background:transparent;border-radius:5px;box-sizing:content-box;color:#fff;font-size:1.2em;overflow:hidden;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:after{box-shadow:inset 0 34px 16px -16px hsla(0,0%,100%,.4)}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:after, .action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:before{bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:before{box-shadow:inset 0 1px 1px -1px #fff,inset 0 2px 1px 0 hsla(0,0%,100%,.4),inset 0 -1px 2px -1px hsla(0,0%,100%,.4)}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;z-index:2}.action[_ngcontent-%COMP%]   .action-internal[_ngcontent-%COMP%]:last-child{margin-right:0}.potion[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/potions.png);background-repeat:no-repeat;display:block}.potion.PotionIconsAdd_01[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -5px}.potion.PotionIconsAdd_02[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -5px}.potion.PotionIconsAdd_03[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -5px}.potion.PotionIconsAdd_04[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -5px}.potion.PotionIconsAdd_05[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -5px}.potion.PotionIconsAdd_06[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -5px}.potion.PotionIconsAdd_07[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -5px}.potion.PotionIconsAdd_08[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -5px}.potion.PotionIconsAdd_09[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -5px}.potion.PotionIconsAdd_10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -5px}.potion.az_bottle1[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -5px}.potion.az_bottle10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -5px}.potion.az_bottle2[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -63px}.potion.az_bottle3[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -63px}.potion.az_bottle4[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -63px}.potion.az_bottle5[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -63px}.potion.az_bottle6[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -63px}.potion.az_bottle7[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -63px}.potion.az_bottle8[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -63px}.potion.az_bottle9[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -63px}.potion.t_01[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -63px}.potion.t_02[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -63px}.potion.t_03[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -63px}.potion.t_04[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -63px}.potion.t_05[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -121px}.potion.t_06[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -121px}.potion.t_08[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -121px}.potion.t_09[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -121px}.potion.t_10[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -121px}.potion.t_101[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -121px}.potion.t_102[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -121px}.potion.t_103[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -121px}.potion.t_104[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -121px}.potion.t_106[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -121px}.potion.t_108[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -121px}.potion.t_109[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -121px}.potion.t_11[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -179px}.potion.t_110[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -179px}.potion.t_111[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -179px}.potion.t_112[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -179px}.potion.t_115[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -179px}.potion.t_116[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -179px}.potion.t_117[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -179px}.potion.t_118[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -179px}.potion.t_12[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -179px}.potion.t_120[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -179px}.potion.t_122[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -179px}.potion.t_123[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -179px}.potion.t_124[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -237px}.potion.t_126[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -237px}.potion.t_127[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -237px}.potion.t_129[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -237px}.potion.t_13[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -237px}.potion.t_131[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -237px}.potion.t_132[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -237px}.potion.t_133[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -237px}.potion.t_135[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -237px}.potion.t_136[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -237px}.potion.t_138[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -237px}.potion.t_139[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -237px}.potion.t_14[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -295px}.potion.t_141[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -295px}.potion.t_142[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -295px}.potion.t_144[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -295px}.potion.t_145[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -295px}.potion.t_147[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -295px}.potion.t_148[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -295px}.potion.t_15[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -295px}.potion.t_150[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -295px}.potion.t_151[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -295px}.potion.t_153[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -295px}.potion.t_154[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -295px}.potion.t_156[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -353px}.potion.t_157[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -353px}.potion.t_159[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -353px}.potion.t_16[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -353px}.potion.t_160[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -353px}.potion.t_162[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -353px}.potion.t_163[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -353px}.potion.t_165[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -353px}.potion.t_166[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -353px}.potion.t_168[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -353px}.potion.t_169[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -353px}.potion.t_17[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -353px}.potion.t_170[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -411px}.potion.t_171[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -411px}.potion.t_172[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -411px}.potion.t_174[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -411px}.potion.t_175[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -411px}.potion.t_176[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -411px}.potion.t_178[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -411px}.potion.t_179[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -411px}.potion.t_18[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -411px}.potion.t_19[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -411px}.potion.t_20[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -411px}.potion.t_21[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -411px}.potion.t_22[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -469px}.potion.t_23[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -469px}.potion.t_24[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -469px}.potion.t_26[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -469px}.potion.t_27[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -469px}.potion.t_28[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -469px}.potion.t_29[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -469px}.potion.t_30[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -469px}.potion.t_31[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -469px}.potion.t_32[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -469px}.potion.t_34[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -469px}.potion.t_35[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -469px}.potion.t_36[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -527px}.potion.t_37[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -527px}.potion.t_38[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -527px}.potion.t_40[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -527px}.potion.t_41[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -527px}.potion.t_42[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -527px}.potion.t_44[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -527px}.potion.t_45[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -527px}.potion.t_46[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -527px}.potion.t_47[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -527px}.potion.t_49[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -527px}.potion.t_50[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -527px}.potion.t_52[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -585px}.potion.t_53[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -585px}.potion.t_54[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -585px}.potion.t_55[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -585px}.potion.t_57[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -585px}.potion.t_59[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -585px}.potion.t_60[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -585px}.potion.t_61[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -585px}.potion.t_62[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -585px}.potion.t_64[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -585px}.potion.t_65[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -585px}.potion.t_66[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -585px}.potion.t_67[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -643px}.potion.t_68[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -643px}.potion.t_69[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-121px -643px}.potion.t_70[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-179px -643px}.potion.t_72[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-237px -643px}.potion.t_73[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-295px -643px}.potion.t_74[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-353px -643px}.potion.t_75[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-411px -643px}.potion.t_76[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-469px -643px}.potion.t_78[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-527px -643px}.potion.t_79[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-585px -643px}.potion.t_80[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-643px -643px}.potion.t_82[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -5px}.potion.t_83[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -63px}.potion.t_85[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -121px}.potion.t_86[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -179px}.potion.t_88[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -237px}.potion.t_89[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -295px}.potion.t_90[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -353px}.potion.t_91[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -411px}.potion.t_93[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -469px}.potion.t_94[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -527px}.potion.t_95[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -585px}.potion.t_97[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-701px -643px}.potion.t_98[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-5px -701px}.potion.t_99[_ngcontent-%COMP%]{width:48px;height:48px;background-position:-63px -701px}'],changeDetection:0}),t})();class S{constructor(t,o,n,i,p=!0,e){this.ctx=t,this.canvas=o,this.spell=n,this.element=i,this.isNotDebuff=p,this.hero=e,this.cd=this.isNotDebuff?Object(O.h)("swiftness",this.hero,1e3*this.spell.cooldown):Object(O.h)("swiftness",this.hero,1e3*this.spell.duration)}clearCanvas(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}endCooldown(){this.clearCanvas(),this.timer=null;var t=this.canvas,o=this.canvas.getContext("2d");o.fillStyle="rgba(253, 255, 173, 0.5)",o.fillRect(0,0,t.width,t.height),window.setTimeout((function(){o.clearRect(0,0,t.width,t.height)}),20)}gaugeCooldown(){this.timer||this.initiateCooldown()}initiateCooldown(){this.timer||(this.timer=window.setTimeout(this.endCooldown.bind(this),this.cd),this.timerStart=(new Date).getTime(),this.runCooldown())}runCooldown(){if(this.timer){var t=((new Date).getTime()-this.timerStart)/this.cd*360,o=this.canvas,n=this.canvas.getContext("2d"),i=Math.sqrt(Math.pow(this.element.clientWidth,2)+Math.pow(this.element.clientHeight,2));n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,o.width,o.height),o.height=i,o.width=i,o.style.marginLeft=-i/2+"px",o.style.marginTop=-i/2+"px",n.fillStyle="rgba(0, 0, 0, 0.5)",n.translate(o.width/2,o.height/2),n.rotate(-Math.PI/2),n.beginPath(),n.moveTo(0,0),n.lineTo(i/2*Object(h.g)(Math.cos(0).toFixed(15)),i/2*Object(h.g)(Math.sin(0).toFixed(15))),n.lineWidth=2,n.strokeStyle="rgba(255, 255, 255, 0.9)",n.shadowColor="rgba(255, 255, 255, 0.6)",n.shadowBlur=10,n.stroke(),n.moveTo(0,0),n.lineTo(i/2*Object(h.g)(Math.cos(t*Math.PI/180).toFixed(15)),i/2*Object(h.g)(Math.sin(t*Math.PI/180).toFixed(15))),n.stroke(),n.shadowColor=null,n.shadowBlur=null,n.arc(0,0,i/2,t*Math.PI/180,2*Math.PI,!1),n.fill(),n.closePath(),requestAnimationFrame(this.runCooldown.bind(this))}}}function T(t,o){if(1&t&&x.Pb(0,"combat-spell-cooldown",11),2&t){const t=o.$implicit,n=o.index,i=x.dc();x.ic("spell",t)("index",n)("hero",i.hero)("isNotDebuff",!1)}}let B=(()=>{class t{constructor(){}healthPercentage(t){return Math.round(t.hp/t.maxHp*100)}trackByFn(t,o){return t}rewardExp(){return Object(e.c)(this.heroLevel,this.heroLevel-this.fighter.level)}ngOnInit(){}}return t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=x.Ib({type:t,selectors:[["app-combat-monster-hud"]],inputs:{fighter:"fighter",hero:"hero",heroLevel:"heroLevel"},decls:26,vars:14,consts:[["fxLayout","column","fxLayoutAlign","center center"],[1,"combat"],["cardHeader",""],["cardBody",""],["fxLayout","row nowrap"],["fxLayout","column","fxLayoutAlign","space-evenly","fxFlex","grow",1,"stat"],["fxLayout","row","fxLayoutAlign","space-around center"],[1,"myProgress","hp"],[1,"fillingBar"],["fxLayout","row"],["style","transform: scale(0.5);",3,"spell","index","hero","isNotDebuff",4,"ngFor","ngForOf","ngForTrackBy"],[2,"transform","scale(0.5)",3,"spell","index","hero","isNotDebuff"]],template:function(t,o){1&t&&(x.Tb(0,"div",0),x.Tb(1,"app-card",1),x.Rb(2,2),x.Ac(3),x.Qb(),x.Rb(4,3),x.Tb(5,"div",4),x.Tb(6,"div"),x.Pb(7,"i"),x.Sb(),x.Tb(8,"div",5),x.Tb(9,"div",6),x.Tb(10,"label"),x.Ac(11),x.Sb(),x.Tb(12,"label"),x.Ac(13),x.Sb(),x.Sb(),x.Tb(14,"div",6),x.Tb(15,"label"),x.Ac(16),x.Sb(),x.Tb(17,"label"),x.Ac(18),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Tb(19,"div"),x.Tb(20,"div",7),x.Tb(21,"span"),x.Ac(22),x.Sb(),x.Pb(23,"div",8),x.Sb(),x.Tb(24,"div",9),x.yc(25,T,1,4,"combat-spell-cooldown",10),x.Sb(),x.Sb(),x.Qb(),x.Sb(),x.Sb()),2&t&&(x.Bb(3),x.Dc(" ",o.fighter.name," / lvl ",o.fighter.level," "),x.Bb(4),x.Eb("",o.fighter.icon," mob"),x.Bb(4),x.Cc(" Attack : ",o.fighter.attack,""),x.Bb(2),x.Cc(" Defense : ",o.fighter.defense,""),x.Bb(3),x.Cc(" Attack speed : ",o.fighter.attackSpeed/1e3,"/s"),x.Bb(2),x.Cc(" Exp : ",o.rewardExp(),""),x.Bb(4),x.Cc(" ",o.fighter.hp,""),x.Bb(1),x.xc("width",o.healthPercentage(o.fighter),"%"),x.Bb(2),x.ic("ngForOf",null==o.fighter?null:o.fighter.debuffs)("ngForTrackBy",o.trackByFn))},directives:[P.f,P.e,C.a,P.b,i.s,v],styles:[".myProgress[_ngcontent-%COMP%]{display:flex;position:relative;font-size:small;height:30px;width:inherit}.myProgress.mana[_ngcontent-%COMP%]{height:20px;box-shadow:1px 1px 2px #3a529c,-1px -1px 2px #3a529c}.myProgress.mana[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:chambray;transition:width 1s;border-radius:inherit}.myProgress.mana[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #3a529c,-1px -1px 4px #3a529c}.myProgress.hp[_ngcontent-%COMP%]{box-shadow:1px 1px 2px #26a65b,-1px -1px 2px #26a65b}.myProgress.hp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:#26a65b;border-radius:inherit;transition:width 1s}.myProgress.hp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #26a65b,-1px -1px 4px #26a65b}.myProgress.exp[_ngcontent-%COMP%]{width:100%;margin-top:10px;height:15px;box-shadow:1px 1px 2px #f15a22,-1px -1px 2px #f15a22}.myProgress.exp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;background-color:#f15a22;transition:width 1s}.myProgress.exp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #f15a22,-1px -1px 4px #f15a22}.myProgress.miscellaneous[_ngcontent-%COMP%]{height:15px;margin-top:2px;box-shadow:1px 1px 2px orange,-1px -1px 2px orange}.myProgress.miscellaneous[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;transition:width 1s}.myProgress.miscellaneous[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px orange,-1px -1px 4px orange}.myProgress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.mob[_ngcontent-%COMP%]{background-image:url(/RiseOfHeroes/assets/mobs.png);background-repeat:no-repeat;display:block}.mob.Arctic_wolf[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -5px}.mob.Plant_Monster_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -5px}.mob.addons_091[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -5px}.mob.addons_093[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -5px}.mob.addons_095[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -5px}.mob.addons_096[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -5px}.mob.addons_097[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -5px}.mob.ancient_vampire[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -5px}.mob.ash_zombies[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -5px}.mob.banshee[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -5px}.mob.bat_01[_ngcontent-%COMP%]{background-position:-1385px -5px}.mob.bat_01[_ngcontent-%COMP%], .mob.bear[_ngcontent-%COMP%]{width:128px;height:128px}.mob.bear[_ngcontent-%COMP%]{background-position:-5px -143px}.mob.bear_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -143px}.mob.beest_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -143px}.mob.beest_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -143px}.mob.beest_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -143px}.mob.bird_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -143px}.mob.bogard[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -143px}.mob.bone_beast[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -143px}.mob.buddy[_ngcontent-%COMP%]{background-position:-1109px -143px}.mob.buddy[_ngcontent-%COMP%], .mob.bug[_ngcontent-%COMP%]{width:128px;height:128px}.mob.bug[_ngcontent-%COMP%]{background-position:-1247px -143px}.mob.bug2[_ngcontent-%COMP%]{background-position:-1385px -143px}.mob.bug2[_ngcontent-%COMP%], .mob.cat_01[_ngcontent-%COMP%]{width:128px;height:128px}.mob.cat_01[_ngcontent-%COMP%]{background-position:-5px -281px}.mob.chicken_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -281px}.mob.crocodile_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -281px}.mob.crow_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -281px}.mob.crystal_golem_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -281px}.mob.cyclop_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -281px}.mob.dark_knight_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -281px}.mob.dark_knight_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -281px}.mob.dark_knight_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -281px}.mob.dark_knight_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -281px}.mob.demon_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -281px}.mob.demon_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -419px}.mob.demon_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -419px}.mob.demon_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -419px}.mob.demon_05[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -419px}.mob.demon_06[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -419px}.mob.demon_07[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -419px}.mob.demon_08[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -419px}.mob.diver_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -419px}.mob.dog_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -419px}.mob.doll_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -419px}.mob.dragon_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -419px}.mob.dragon_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -557px}.mob.dragon_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -557px}.mob.dragon_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -557px}.mob.dragon_05[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -557px}.mob.dragon_06[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -557px}.mob.dragon_07[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -557px}.mob.dragon_08[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -557px}.mob.dragon_09[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -557px}.mob.dragon_10[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -557px}.mob.dragon_11[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -557px}.mob.dragon_12[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -557px}.mob.dragon_13[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -695px}.mob.dummy_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -695px}.mob.elephant_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -695px}.mob.eye_01[_ngcontent-%COMP%]{background-position:-419px -695px}.mob.eye_01[_ngcontent-%COMP%], .mob.eye_02[_ngcontent-%COMP%]{width:128px;height:128px}.mob.eye_02[_ngcontent-%COMP%]{background-position:-557px -695px}.mob.frog_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -695px}.mob.frost_giant_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -695px}.mob.ghost_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -695px}.mob.ghoul_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -695px}.mob.goat_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -695px}.mob.goblin_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -695px}.mob.goblin_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -833px}.mob.goblin_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -833px}.mob.goblin_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -833px}.mob.golem_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -833px}.mob.golem_01a[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -833px}.mob.golem_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -833px}.mob.golem_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -833px}.mob.golem_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -833px}.mob.gremlin_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -833px}.mob.grey-wolf_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -833px}.mob.horse_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -833px}.mob.hound[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -971px}.mob.insect_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -971px}.mob.insect_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -971px}.mob.insect_03[_ngcontent-%COMP%]{background-position:-419px -971px}.mob.insect_03[_ngcontent-%COMP%], .mob.jin[_ngcontent-%COMP%]{width:128px;height:128px}.mob.jin[_ngcontent-%COMP%]{background-position:-557px -971px}.mob.joker_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -971px}.mob.joker_02[_ngcontent-%COMP%]{background-position:-833px -971px}.mob.joker_02[_ngcontent-%COMP%], .mob.l_01[_ngcontent-%COMP%]{width:128px;height:128px}.mob.l_01[_ngcontent-%COMP%]{background-position:-971px -971px}.mob.l_02[_ngcontent-%COMP%]{background-position:-1109px -971px}.mob.l_02[_ngcontent-%COMP%], .mob.l_03[_ngcontent-%COMP%]{width:128px;height:128px}.mob.l_03[_ngcontent-%COMP%]{background-position:-1247px -971px}.mob.lion_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -971px}.mob.living_armor_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -1109px}.mob.living_armor_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -1109px}.mob.living_armor_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -1109px}.mob.living_armor_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -1109px}.mob.lizardman_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -1109px}.mob.madman[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -1109px}.mob.mask_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -1109px}.mob.mummy_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -1109px}.mob.nightmare_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -1109px}.mob.ogr_01[_ngcontent-%COMP%]{background-position:-1247px -1109px}.mob.ogr_01[_ngcontent-%COMP%], .mob.orc_01[_ngcontent-%COMP%]{width:128px;height:128px}.mob.orc_01[_ngcontent-%COMP%]{background-position:-1385px -1109px}.mob.orc_02[_ngcontent-%COMP%]{background-position:-5px -1247px}.mob.orc_02[_ngcontent-%COMP%], .mob.orc_03[_ngcontent-%COMP%]{width:128px;height:128px}.mob.orc_03[_ngcontent-%COMP%]{background-position:-143px -1247px}.mob.orc_04[_ngcontent-%COMP%]{background-position:-281px -1247px}.mob.orc_04[_ngcontent-%COMP%], .mob.orc_05[_ngcontent-%COMP%]{width:128px;height:128px}.mob.orc_05[_ngcontent-%COMP%]{background-position:-419px -1247px}.mob.owl_01[_ngcontent-%COMP%]{background-position:-557px -1247px}.mob.owl_01[_ngcontent-%COMP%], .mob.ox_01[_ngcontent-%COMP%]{width:128px;height:128px}.mob.ox_01[_ngcontent-%COMP%]{background-position:-695px -1247px}.mob.parasit_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -1247px}.mob.parasit_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -1247px}.mob.phoenix_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -1247px}.mob.pig_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -1247px}.mob.pumpkin[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -1247px}.mob.rat_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -1385px}.mob.red_ghoul_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -1385px}.mob.robot_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -1385px}.mob.robot_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -1385px}.mob.robot_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -1385px}.mob.robot_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -1385px}.mob.robot_05[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-833px -1385px}.mob.sheep_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-971px -1385px}.mob.skeleton_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1109px -1385px}.mob.skeleton_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1247px -1385px}.mob.skeleton_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1385px -1385px}.mob.skeleton_04[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -5px}.mob.skeleton_05[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -143px}.mob.skeleton_06[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -281px}.mob.skeleton_07[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -419px}.mob.snail_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -557px}.mob.snail_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -695px}.mob.snake_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -833px}.mob.spider_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -971px}.mob.spider_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -1109px}.mob.spider_03[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -1247px}.mob.tentacle_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-1523px -1385px}.mob.troll_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-5px -1523px}.mob.turtle_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-143px -1523px}.mob.werewolf_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-281px -1523px}.mob.yeti_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-419px -1523px}.mob.zombie_01[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-557px -1523px}.mob.zombie_02[_ngcontent-%COMP%]{width:128px;height:128px;background-position:-695px -1523px}.stat[_ngcontent-%COMP%]{height:10vh}"]}),t})();var I=n("XNiG"),$=n("zp1y"),A=n("++hd");function L(t,o){if(1&t){const t=x.Ub();x.Tb(0,"combat-spell-cooldown",11),x.bc("rdy",(function(o){return x.rc(t),x.dc().casted(o)}))("click",(function(){x.rc(t);const n=o.$implicit;return x.dc().doCastSpell$.next({spell:n,hotKey:""})})),x.ec(1,"async"),x.Sb()}if(2&t){const t=o.$implicit,n=o.index,i=x.dc();x.ic("tooltip",t)("tooltip-detach",i.spellCasted)("tooltip-type","spell")("spell",t)("index",n)("hero",x.fc(1,6,i.hero$))}}function F(t,o){if(1&t){const t=x.Ub();x.Tb(0,"combat-spell-cooldown",12),x.bc("rdy",(function(o){return x.rc(t),x.dc().casted(o)}))("click",(function(){x.rc(t);const n=o.ngIf;return x.dc().doUsePotion$.next({potion:n})})),x.ec(1,"async"),x.ec(2,"async"),x.Sb()}if(2&t){const t=o.ngIf,n=x.dc();x.ic("tooltip",t)("tooltip-detach",n.spellCasted)("potion",x.fc(1,5,n.potion$))("index",5)("hero",x.fc(2,7,n.hero$))}}let j=(()=>{class t{constructor(t){this.store=t,this.hero$=this.store.select(s.e),this.castSpell=new x.n,this.spellCasted=new x.n,this.healthPercentage$=this.hero$.pipe(Object(p.a)(t=>t?Math.round(t.hp/t.maxHp*100):0)),this.expPercentage$=this.hero$.pipe(Object(p.a)(t=>t?Math.round(t.exp/this.getXPForLevel(t.level)*100):0)),this.potion$=this.hero$.pipe(Object(p.a)(t=>t.potion)),this.doCastSpell$=new I.a,this._castSpellSubscription=this.doCastSpell$.pipe(Object($.a)(this.hero$,(t,o)=>{if(""!=t.hotKey)o.equippedSpell.forEach((o,n)=>{t.hotKey===(n+1).toString()&&(o.isInCooldown||(this.castSpell.emit(o),this.casted(!0)))});else{if(t.spell.isInCooldown)return;this.castSpell.emit(t.spell),this.casted(!0)}})).subscribe(),this.doUsePotion$=new I.a,this._usePotionSubscription=this.doUsePotion$.pipe(Object($.a)(this.hero$,(t,o)=>{t.potion.isInCooldown||(this.castSpell.emit(t.potion),this.spellCasted.emit(!0))})).subscribe()}casted(t){this.spellCasted.emit(t)}cast(t){let o="";"keydown"==event.type&&(o=String.fromCharCode(event.keyCode)),this.doCastSpell$.next({spell:t,hotKey:o})}getXPForLevel(t){return Object(e.a)(t)}trackByFn(t,o){return o}ngOnInit(){}ngOnDestroy(){this._castSpellSubscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(x.Ob(_.h))},t.\u0275cmp=x.Ib({type:t,selectors:[["app-combat-hero-hud"]],hostBindings:function(t,o){1&t&&x.bc("keydown",(function(){return o.cast()}),!1,x.qc)},outputs:{castSpell:"castSpell",spellCasted:"spellCasted"},decls:27,vars:30,consts:[["fxLayout","row","fxLayoutAlign","center center",1,"ui-container"],[1,"combat"],["cardHeader",""],["cardBody",""],[1,"myProgress","hp"],[1,"fillingBar"],[1,"myProgress","exp"],["cardFooter",""],["fxLayout","row","fxLayoutAlign","center center"],[3,"tooltip","tooltip-detach","tooltip-type","spell","index","hero","rdy","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"tooltip","tooltip-detach","potion","index","hero","rdy","click",4,"ngIf"],[3,"tooltip","tooltip-detach","tooltip-type","spell","index","hero","rdy","click"],[3,"tooltip","tooltip-detach","potion","index","hero","rdy","click"]],template:function(t,o){1&t&&(x.Tb(0,"div",0),x.Tb(1,"app-card",1),x.Rb(2,2),x.Ac(3),x.ec(4,"async"),x.Qb(),x.Rb(5,3),x.Tb(6,"div"),x.Tb(7,"div",4),x.Tb(8,"span"),x.Ac(9),x.ec(10,"async"),x.ec(11,"async"),x.Sb(),x.Tb(12,"div",5),x.ec(13,"async"),x.Sb(),x.Sb(),x.Tb(14,"div",6),x.Tb(15,"span"),x.Ac(16),x.ec(17,"async"),x.ec(18,"async"),x.Sb(),x.Tb(19,"div",5),x.ec(20,"async"),x.Sb(),x.Sb(),x.Sb(),x.Qb(),x.Rb(21,7),x.Tb(22,"div",8),x.yc(23,L,2,8,"combat-spell-cooldown",9),x.ec(24,"async"),x.yc(25,F,3,9,"combat-spell-cooldown",10),x.ec(26,"async"),x.Sb(),x.Qb(),x.Sb(),x.Sb()),2&t&&(x.Bb(3),x.Cc(" You / lvl ",x.fc(4,12,o.hero$).level," "),x.Bb(6),x.Dc(" ",x.fc(10,14,o.hero$).hp," / ",x.fc(11,16,o.hero$).maxHp,""),x.Bb(3),x.xc("width",x.fc(13,18,o.healthPercentage$),"%"),x.Bb(4),x.Dc(" ",x.fc(17,20,o.hero$).exp," / ",o.getXPForLevel(x.fc(18,22,o.hero$).level),""),x.Bb(3),x.xc("width",x.fc(20,24,o.expPercentage$),"%"),x.Bb(4),x.ic("ngForOf",x.fc(24,26,o.hero$).equippedSpell)("ngForTrackBy",o.trackByFn),x.Bb(2),x.ic("ngIf",x.fc(26,28,o.potion$)))},directives:[P.f,P.e,C.a,i.s,i.t,v,A.a],pipes:[i.b],styles:[".myProgress[_ngcontent-%COMP%]{display:flex;position:relative;font-size:small;height:30px;width:inherit}.myProgress.mana[_ngcontent-%COMP%]{height:20px;box-shadow:1px 1px 2px #3a529c,-1px -1px 2px #3a529c}.myProgress.mana[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:chambray;transition:width 1s;border-radius:inherit}.myProgress.mana[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #3a529c,-1px -1px 4px #3a529c}.myProgress.hp[_ngcontent-%COMP%]{box-shadow:1px 1px 2px #26a65b,-1px -1px 2px #26a65b}.myProgress.hp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{background-color:#26a65b;border-radius:inherit;transition:width 1s}.myProgress.hp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #26a65b,-1px -1px 4px #26a65b}.myProgress.exp[_ngcontent-%COMP%]{width:100%;margin-top:10px;height:15px;box-shadow:1px 1px 2px #f15a22,-1px -1px 2px #f15a22}.myProgress.exp[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;background-color:#f15a22;transition:width 1s}.myProgress.exp[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px #f15a22,-1px -1px 4px #f15a22}.myProgress.miscellaneous[_ngcontent-%COMP%]{height:15px;margin-top:2px;box-shadow:1px 1px 2px orange,-1px -1px 2px orange}.myProgress.miscellaneous[_ngcontent-%COMP%]   .fillingBar[_ngcontent-%COMP%]{border-radius:inherit;transition:width 1s}.myProgress.miscellaneous[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 4px orange,-1px -1px 4px orange}.myProgress[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}[_nghost-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;bottom:0;width:100vw}.ui-container[_ngcontent-%COMP%]{width:500px}.ui-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px;width:48px;height:48px;box-shadow:0 0 1px .5px #fff}"]}),t})(),z=(()=>{class t{constructor(t,o,n,i){this.store=t,this.route=o,this.combatService=n,this.router=i,this.hero$=this.store.select(s.e),this.city$=this.store.select(Object(g.a)(this.route.snapshot.paramMap.get("cityId")))}activateSpell(t){"item"==t.type?this.combatService.usePotion(t):this.combatService.activateSpell(t)}ngOnInit(){let t=c.m.findIndex(t=>t.name===this.route.snapshot.paramMap.get("monster"));this.city$.pipe(Object(a.a)(1)).subscribe(o=>{let n=o.building.find(t=>"huntingPost"==t.type).actions.find(o=>o.targetId===t).currentLevel;this.fighter=Object(b.a)(c.m[t],n)}),this.combatService.fighter=this.fighter,this.subscription=this.hero$.subscribe(t=>this.combatService.initialize(t))}ngOnDestroy(){this.hero$.pipe(Object(r.a)()).subscribe(t=>this.store.dispatch(new d.n(Object.assign(Object.assign({},t),{hp:t.maxHp})))),this.subscription.unsubscribe(),this.combatService.stop()}}return t.\u0275fac=function(o){return new(o||t)(x.Ob(_.h),x.Ob(u.a),x.Ob(l.a),x.Ob(u.f))},t.\u0275cmp=x.Ib({type:t,selectors:[["app-combat"]],decls:5,vars:7,consts:[["fxLayout","row nowrap","fxLayoutAlign","center center"],[3,"fighter","hero","heroLevel"],[3,"castSpell"]],template:function(t,o){1&t&&(x.Tb(0,"div",0),x.Pb(1,"app-combat-monster-hud",1),x.ec(2,"async"),x.ec(3,"async"),x.Sb(),x.Tb(4,"app-combat-hero-hud",2),x.bc("castSpell",(function(t){return o.activateSpell(t)})),x.Sb()),2&t&&(x.Bb(1),x.ic("fighter",o.fighter)("hero",x.fc(2,3,o.hero$))("heroLevel",x.fc(3,5,o.hero$).level))},directives:[P.f,P.e,B,j],pipes:[i.b],styles:[""]}),t})();var D=n("PCNd");let R=(()=>{class t{}return t.\u0275mod=x.Mb({type:t}),t.\u0275inj=x.Lb({factory:function(o){return new(o||t)},imports:[[i.c,D.a,u.i.forChild([{path:"",component:z}])]]}),t})()}}]);